mixin link(href, name)
  - let style;
  if (path === href)
    if (loggedIn)
      if (familyColors[name])
        - style = `color: ${familyColors[name]}`
      else
        - style = `color: ${familyColors[user.family.name]}`
    else
      - style = "text-decoration: underline"
  a(class!=attributes.class href=href style=style)!= name

doctype html
html
  head
    title= title
    meta(charset="utf-8")
    meta(name="viewport" content="width=device-width, initial-scale=1")
    link(rel='stylesheet', href='/stylesheets/style.css')
    block head-scripts
      script(src="/libs/jquery.min.js")
      script(src="/javascripts/main.js")

  body
    nav.col-12
      .top
        .subtitle.logo
          a(href="/") LPN Fitness
        if isLoggedIn
          .hamburger-button
            .line
            .line
            .line
      if isLoggedIn
        .nav-links
          +link(home, "Home")
          - var familyNames = ["Alexandrite", "Emerald", "Iolite", "Ruby", "Sapphire", "Sunstone", "Topaz"]
          +link("#", "Families <span class='down-arrow'>&#9660;</span>")(class="drop-down")
          .drop-down-links
            each familyName in familyNames
              +link(`/families/${familyName}`, familyName)
          +link("/challenges", `Challenges (${challengeCount})`)
          +link("/activities", "Activities")
          +link("/schedule", "Schedule")
          +link("/rules", "Rules")
          if user.admin
            +link("#", "Settings <span class='down-arrow'>&#9660;</span>")(class="drop-down")
            .drop-down-links
              +link(`/users/admin-settings`, "Admin")
              +link(`/users/${user.email}`, "Profile")
          else
            +link(`/users/${user.email}`, "Profile")
          +link("/logout", "Logout")

    .clear

    block content

    block footer-scripts
      script.
        $('body').on('click', '.drop-down', e => $(e.target).next().slideToggle())

        let reverse = false;
        $('body').on('click', ".hamburger-button", e => {
          if (reverse) {
            $(e.currentTarget).removeClass("animate-x");
            $(e.currentTarget).addClass("animate-x-reverse");
            $(".nav-links").removeClass("move-nav-down");
            $(".nav-links").addClass("move-nav-up");
            setTimeout(() => $(".nav-links").css("display", "none"), 200);
            reverse = !reverse;
          } else {
            $(e.currentTarget).removeClass("animate-x-reverse")
            $(e.currentTarget).addClass("animate-x");
            $(".nav-links").removeClass("move-nav-up");
            $(".nav-links").css("display", "block");
            $(".nav-links").addClass("move-nav-down");
            reverse = !reverse;
          }
        })